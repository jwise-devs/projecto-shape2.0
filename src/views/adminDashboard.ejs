<!DOCTYPE html>
<html lang="en">
<%- include('includes/head') %>
    <title>Procedimentos</title>

    <body>
        <%- include('includes/navbar') %>

            <div class="container">
                <div class="row">
                    <div class="col-lg-2"></div>

                    <div class="col-lg-8 my-3">
                        <h1 class="text-center">Procedimentos</h1>
                        <p class="text-center lead">Seus procedimentos estão abaixo</p>

                        <%- include('includes/messeges') %>

                            <!-- Botões alinhados verticalmente -->
                            <div class="d-grid gap-3 mt-4 btn-lg py-3 ">
                                <a href="/clientes" class="btn btn-primary">Clientes</a>
                                <a href="/marcacoes" class="btn btn-primary">Marcacoes</a>
                                <a href="/procedimentos" class="btn btn-primary">Procedimentos em Andamento</a>
                                <a href="https://mail.google.com/mail/u/0/#search/subject:(Consulta+em+casa)"
                                    class="btn btn-primary position-relative" id="emailNotificationBtn" target="_blank">
                                    Requisições de Consulta em Casa
                                    <span id="emailCount"
                                        class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                                        style="display: none;">
                                    </span>
                                </a>
                                <a href="/admincadastro/create/verificador" class="btn btn-primary">Cadastrar
                                    Usuario</a>
                                <a href="/procedimentos/list" class="btn btn-primary">Verificar Procedimentos</a>
                                <a href="/procedimentos/create" class="btn btn-primary">Criar Procedimentos</a>
                                <a href="/funcionarios/create" class="btn btn-primary">Cadastrar
                                    pupilas</a>
                                    <a href="/funcionarios" class="btn btn-primary">Listar Pupilas</a>
                            </div>

                    </div>

                    <div class="col-lg-2"></div>
                </div>
            </div>

            <%- include('includes/script') %>

                <script>
                    function fetchEmailCount() {
                        fetch("/emails/count")
                            .then(response => response.json())
                            .then(data => {
                                const emailCountSpan = document.getElementById("emailCount");
                                if (data.success && data.count > 0) {
                                    emailCountSpan.textContent = data.count;
                                    emailCountSpan.style.display = "inline-block";
                                } else {
                                    emailCountSpan.style.display = "none";
                                }
                            })
                            .catch(error => console.error("Erro ao buscar e-mails:", error));
                    }

                    setInterval(fetchEmailCount, 30000);
                    fetchEmailCount();
                </script>
    </body>

</html>